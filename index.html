<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Base44 AI | Builder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    colors: {
                        brand: {
                            orange: '#f97316', // Laranja da Landing
                            purple: '#7c3aed', // Roxo do Editor
                            bg: '#f9fafb'
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* CSS ESPECÍFICO PARA FICAR IGUAL ÀS FOTOS */
        body { background-color: #f9fafb; color: #111827; overflow: hidden; }
        
        /* Landing Page - Fundo Gradiente Suave */
        #view-landing {
            background: linear-gradient(135deg, #f0f4ff 0%, #fff5f5 50%, #fdfae8 100%);
            overflow-y: auto;
        }

        /* Input Cápsula (Igual Foto 1) */
        .input-capsule {
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
        }
        .input-capsule:focus-within { transform: translateY(-2px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); }

        /* Editor (Igual Foto 2) */
        .editor-sidebar { background-color: #f9fafb; border-right: 1px solid #e5e7eb; }
        .chat-bubble-ai { background: white; border: 1px solid #e5e7eb; color: #374151; border-radius: 12px 12px 12px 0; }
        .chat-bubble-user { background: #7c3aed; color: white; border-radius: 12px 12px 0 12px; }
        
        /* Tabs do Editor */
        .nav-tab { border-bottom: 2px solid transparent; color: #6b7280; }
        .nav-tab.active { border-bottom: 2px solid #7c3aed; color: #7c3aed; font-weight: 600; }

        /* Animações */
        .fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="h-screen flex flex-col">

    <section id="view-landing" class="h-full flex flex-col">
        <header class="flex justify-between items-center px-8 py-6">
            <div class="flex items-center gap-2 font-bold text-xl text-gray-800">
                <span class="text-brand-orange text-2xl">●</span> Base44
            </div>
            <nav class="hidden md:flex gap-8 text-sm font-medium text-gray-600">
                <a href="#" class="hover:text-black">Preços</a>
                <a href="#" class="hover:text-black">Empresarial</a>
                <a href="#" class="hover:text-black">Showcase</a>
            </nav>
            <div class="flex items-center gap-4">
                <a href="#" class="text-gray-500 hover:text-black"><i class="fas fa-globe"></i></a>
                <button onclick="navigateTo('editor')" class="bg-brand-orange text-white px-6 py-2.5 rounded-full font-bold text-sm hover:bg-orange-600 transition shadow-lg shadow-orange-200">Comece já</button>
            </div>
        </header>

        <main class="flex-1 flex flex-col items-center pt-20 px-4 text-center fade-in">
            <h1 class="text-5xl md:text-7xl font-extrabold text-gray-900 leading-[1.1] mb-6 tracking-tight">
                Transforme seu sonho em <span class="text-indigo-400">realidade</span>.<br>
                Crie um app com IA agora.
            </h1>
            <p class="text-xl text-gray-500 max-w-2xl mb-12 font-light">
                Com a Base44, você cria aplicativos totalmente funcionais em minutos, usando apenas suas palavras. Sem precisar programar.
            </p>

            <div class="input-capsule w-full max-w-2xl bg-white rounded-full p-2 flex items-center border border-gray-200 relative z-10">
                <input type="text" id="landingInput" class="flex-1 bg-transparent px-6 text-lg outline-none text-gray-700 placeholder-gray-400 h-14" placeholder="O que você quer criar? (ex: Site Roxo para SaaS)">
                <button onclick="startCreation()" class="bg-brand-orange text-white px-8 h-14 rounded-full font-bold text-lg hover:bg-orange-600 transition flex items-center gap-2">
                    Criar <i class="fas fa-arrow-right"></i>
                </button>
            </div>

            <p class="text-sm text-gray-400 mt-10 mb-4">Não sabe por onde começar? Experimente:</p>
            <div class="flex flex-wrap justify-center gap-3">
                <button onclick="fillInput('Painel de relatórios dark mode')" class="bg-white border border-gray-200 px-4 py-2 rounded-full text-sm text-gray-600 hover:border-brand-orange hover:text-brand-orange transition">Painel de relatórios</button>
                <button onclick="fillInput('Landing page roxa para startup')" class="bg-white border border-gray-200 px-4 py-2 rounded-full text-sm text-gray-600 hover:border-brand-orange hover:text-brand-orange transition">Landing Page SaaS</button>
                <button onclick="fillInput('Portfolio minimalista')" class="bg-white border border-gray-200 px-4 py-2 rounded-full text-sm text-gray-600 hover:border-brand-orange hover:text-brand-orange transition">Portfólio</button>
            </div>
        </main>
    </section>

    <section id="view-editor" class="hidden h-full flex flex-col bg-white">
        <header class="h-16 border-b border-gray-200 flex justify-between items-center px-6 bg-white shrink-0">
            <div class="flex items-center gap-6">
                <div class="flex items-center gap-2 font-bold text-lg text-gray-800">
                    <span class="text-brand-orange text-xl">●</span> Base44
                </div>
                <div class="flex items-center text-sm gap-2 text-gray-500 border-l border-gray-200 pl-6 h-8">
                    <span>Nova</span>
                    <span class="text-gray-300">/</span>
                    <span class="font-medium text-gray-700">Espaço Pessoal</span>
                </div>
            </div>
            
            <div class="flex h-full gap-8 text-sm">
                <button class="nav-tab h-full px-2">Painel</button>
                <button class="nav-tab active h-full px-2">Pré-visualização</button>
                <button class="nav-tab h-full px-2">Integrações</button>
            </div>

            <div class="flex items-center gap-3">
                <button class="p-2 text-gray-400 hover:text-gray-600"><i class="fas fa-undo"></i></button>
                <button class="p-2 text-gray-400 hover:text-gray-600"><i class="fas fa-redo"></i></button>
                <div class="h-6 w-px bg-gray-200 mx-2"></div>
                <button class="bg-white border border-gray-300 text-gray-700 px-4 py-1.5 rounded-lg text-sm font-semibold hover:bg-gray-50">Atualizar</button>
                <button class="bg-brand-purple text-white px-4 py-1.5 rounded-lg text-sm font-semibold hover:bg-purple-800 shadow-md shadow-purple-200">Publicar</button>
                <div class="w-8 h-8 rounded-full bg-indigo-100 text-indigo-600 flex items-center justify-center font-bold text-xs ml-2">US</div>
            </div>
        </header>

        <div class="flex-1 flex overflow-hidden">
            <aside class="w-[350px] editor-sidebar flex flex-col z-10 shadow-sm">
                <div class="p-4 border-b border-gray-200 flex justify-between items-center bg-white">
                    <span class="font-semibold text-sm text-gray-700">Base44 AI</span>
                    <i class="fas fa-ellipsis-h text-gray-400 cursor-pointer"></i>
                </div>
                
                <div id="chat-history" class="flex-1 overflow-y-auto p-5 space-y-6">
                    <div class="flex flex-col gap-2 items-start fade-in">
                        <div class="chat-bubble-ai p-3 text-sm shadow-sm">
                            Olá! Sou a IA da Base44. Vamos transformar sua ideia em realidade. O que vamos construir hoje?
                        </div>
                    </div>
                </div>

                <div class="p-4 bg-white border-t border-gray-200">
                    <div class="relative">
                        <textarea id="editorInput" class="w-full border border-gray-300 rounded-xl p-3 pr-10 text-sm focus:border-brand-purple focus:ring-1 focus:ring-brand-purple outline-none resize-none h-[50px]" placeholder="Descreva a alteração..."></textarea>
                        <button onclick="generateSite()" class="absolute right-2 bottom-2 w-8 h-8 bg-brand-purple text-white rounded-lg flex items-center justify-center hover:bg-purple-800 transition">
                            <i class="fas fa-arrow-up text-xs"></i>
                        </button>
                    </div>
                    <div class="flex gap-4 mt-2 justify-center">
                        <button class="text-xs text-gray-400 hover:text-brand-purple flex items-center gap-1"><i class="fas fa-magic"></i> Sugestões</button>
                        <button class="text-xs text-gray-400 hover:text-brand-purple flex items-center gap-1"><i class="fas fa-image"></i> Templates</button>
                    </div>
                </div>
            </aside>

            <main class="flex-1 bg-gray-100 p-6 flex justify-center items-center">
                <div class="w-full h-full bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden flex flex-col">
                    <div class="h-9 bg-gray-50 border-b border-gray-200 flex items-center px-4 gap-4">
                        <div class="flex gap-1.5">
                            <div class="w-3 h-3 rounded-full bg-gray-300"></div>
                            <div class="w-3 h-3 rounded-full bg-gray-300"></div>
                            <div class="w-3 h-3 rounded-full bg-gray-300"></div>
                        </div>
                        <div class="flex-1 bg-white border border-gray-200 h-6 rounded flex items-center justify-center text-[10px] text-gray-400 font-mono">
                            base44.preview/app/v1
                        </div>
                    </div>
                    
                    <div class="flex-1 relative">
                        <div id="loadingState" class="hidden absolute inset-0 z-50 flex flex-col items-center justify-center bg-white/90 backdrop-blur-sm">
                            <div class="w-10 h-10 border-4 border-brand-purple border-t-transparent rounded-full animate-spin mb-4"></div>
                            <div class="text-brand-purple font-medium text-xs animate-pulse">GERANDO INTERFACE...</div>
                        </div>
                        <div id="emptyState" class="absolute inset-0 flex flex-col items-center justify-center text-gray-400">
                            <i class="fas fa-layer-group text-4xl mb-4 opacity-20"></i>
                            <span class="text-xs uppercase tracking-widest opacity-50">Preview Vazio</span>
                        </div>
                        <iframe id="siteFrame" class="w-full h-full border-0 hidden"></iframe>
                    </div>
                </div>
            </main>
        </div>
    </section>

    <script>
        let currentCode = "";

        // NAVEGAÇÃO
        function navigateTo(view) {
            document.getElementById('view-landing').classList.add('hidden');
            document.getElementById('view-editor').classList.add('hidden');
            document.getElementById('view-' + view).classList.remove('hidden');
        }

        function fillInput(text) {
            document.getElementById('landingInput').value = text;
        }

        // FLUXO: LANDING -> EDITOR
        function startCreation() {
            const prompt = document.getElementById('landingInput').value;
            if(!prompt) return;
            
            navigateTo('editor');
            
            // Injeta o prompt no editor e dispara
            setTimeout(() => {
                document.getElementById('editorInput').value = prompt;
                generateSite();
            }, 500);
        }

        // LÓGICA DE GERAÇÃO (CONECTADA À API)
        async function generateSite() {
            const input = document.getElementById('editorInput');
            const history = document.getElementById('chat-history');
            const prompt = input.value.trim();
            if(!prompt) return;

            // 1. UI do Usuário
            const uDiv = document.createElement('div');
            uDiv.className = "flex flex-col gap-2 items-end fade-in";
            uDiv.innerHTML = `<div class="chat-bubble-user p-3 text-sm shadow-md">${prompt}</div>`;
            history.appendChild(uDiv);
            input.value = ""; 
            history.scrollTop = history.scrollHeight;

            // 2. Loading
            const loading = document.getElementById('loadingState');
            const frame = document.getElementById('siteFrame');
            const empty = document.getElementById('emptyState');
            loading.classList.remove('hidden');

            try {
                // CHAMA A SUA API REAL
                const response = await fetch('/api/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ prompt, existingCode: currentCode })
                });
                
                const data = await response.json();
                
                if (data.html) {
                    currentCode = data.html;
                    
                    const doc = frame.contentWindow.document;
                    doc.open(); doc.write(currentCode); doc.close();
                    
                    empty.classList.add('hidden');
                    frame.classList.remove('hidden');

                    // 3. UI da IA
                    const aiDiv = document.createElement('div');
                    aiDiv.className = "flex flex-col gap-2 items-start fade-in";
                    aiDiv.innerHTML = `<div class="chat-bubble-ai p-3 text-sm shadow-sm">Interface gerada com sucesso! Configurei o gradiente e a tipografia conforme solicitado.</div>`;
                    history.appendChild(aiDiv);
                    history.scrollTop = history.scrollHeight;
                }
            } catch (e) {
                console.error(e);
                alert("Erro ao conectar com a API. Verifique sua chave.");
            } finally {
                loading.classList.add('hidden');
            }
        }
    </script>
</body>
</html>
